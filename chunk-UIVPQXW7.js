import{f as bt,h as S,i as It,j as kt,k as Vt,l as ei,m as ti,n as ie}from"./chunk-EHZ6LGTW.js";import{h as $t,i as Bt,j as Kt,l as zt,m as jt,o as Gt,p as Ht,r as Xt,s as qt,u as Zt,v as Wt,w as Qt,x as ke,y as Yt,z as Jt}from"./chunk-F5AG67GN.js";import"./chunk-PYM2POMD.js";import{i as ii,j as ni,l as ri,q as ai}from"./chunk-F7SIOTBY.js";import{d as oi}from"./chunk-QEDBGLFO.js";import{c as ee,d as te}from"./chunk-PDKMJN2Z.js";import{d as Ut,f as Tt,g as Dt,h as Ft}from"./chunk-4A3OJW5V.js";import{a as Lt,b as Rt,e as Nt}from"./chunk-MN4LMCKE.js";import{a as Ue,b as Te}from"./chunk-XQJT4HS4.js";import{a as Et,b as At}from"./chunk-MJCEQZQC.js";import{b as Pt,d as Ae,e as Mt,f as xt,h as Ie,i as wt,n as K,o as z,r as yt,t as Ot,v as j,x as St}from"./chunk-NECU6HEY.js";import{Bb as Y,Cb as J,Da as vt,Eb as Ce,Gb as U,Ja as V,Jb as Pe,Kb as Me,La as L,Oa as R,Pa as ve,Qb as xe,Ta as Z,Ua as N,Ub as we,Vb as ye,_b as Ct,ac as Oe,bc as Se,cc as Ee,d as pt,e as F,gc as $,ic as B,ja as _t,k as he,pa as ht,q as ut,r as ft,s as gt,ub as W,vb as be,yb as Q}from"./chunk-BL6LWGXP.js";import{Ac as fe,Bc as ct,Ca as tt,D as Ye,Da as it,Db as ue,Eb as g,F as oe,Gc as C,Hc as P,Ic as ge,Ja as nt,K as se,Kb as T,Lb as p,Lc as Ke,Mb as Fe,Nb as G,Pb as ot,Pc as q,Ra as rt,Sa as at,Sb as y,Sc as ze,Tb as Ve,Tc as je,Ub as Le,Vb as Re,W as Je,Wb as r,Xb as a,Yb as v,Z as le,Zb as A,_b as I,ac as O,ba as me,da as et,dc as b,fc as d,ga as _,gc as st,hb as ce,hc as lt,hd as _e,ic as mt,jb as o,kd as dt,lc as Ne,m as Qe,mc as $e,nc as Be,pd as D,qc as X,ra as x,rb as de,rc as m,sa as w,sc as h,tc as k,xb as E,yb as pe}from"./chunk-ZR6WDTF5.js";import{a as ne,b as ae}from"./chunk-4X36HX5K.js";var si=(()=>{class n{constructor(){this.auth=_(j),this.router=_(ft),this.http=_(F),this.sanitizer=_(he),this.dashboardService=_(Vt),this.defaultAvatarPlaceholder="images/avatar.jpg",this.apiUrl=S.baseUrl,this.avatarObjectUrl=null,this.avatarUrl=this.defaultAvatarPlaceholder,this.isLoadingUser=!0}ngOnInit(){this.auth.user().pipe(se((e,i)=>e.id===i.id),le(e=>{this.user=e,this.loadAvatar(e.id),this.isLoadingUser=!1}),oe(100)).subscribe()}logout(){this.auth.logout().subscribe(()=>{this.dashboardService.clearPatrimonioCache(),this.router.navigateByUrl("/auth/login")})}loadAvatar(e){if(!e){console.warn("ProfileLayoutComponent: No user ID provided for avatar loading"),this.avatarUrl=this.defaultAvatarPlaceholder;return}this.http.get(`${this.apiUrl}/api/avatars/${e}`,{responseType:"blob"}).subscribe({next:i=>{this.avatarObjectUrl&&URL.revokeObjectURL(this.avatarObjectUrl),this.avatarObjectUrl=URL.createObjectURL(i),this.avatarUrl=this.sanitizer.bypassSecurityTrustUrl(this.avatarObjectUrl)},error:i=>{console.warn("ProfileLayoutComponent: Failed to load avatar:",i),i instanceof pt&&i.status===404?this.avatarUrl=this.defaultAvatarPlaceholder:(console.error("ProfileLayoutComponent: An unexpected error occurred while loading avatar."),this.avatarUrl=this.defaultAvatarPlaceholder)}})}ngOnDestroy(){this.avatarObjectUrl&&(URL.revokeObjectURL(this.avatarObjectUrl),this.avatarObjectUrl=null)}onImageError(e){console.warn("ProfileLayoutComponent: Image failed to load:",e.target.src),e.target.src=this.defaultAvatarPlaceholder,this.avatarUrl=this.defaultAvatarPlaceholder}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-profile-layout"]],decls:26,vars:11,consts:[[1,"bg-dark","text-light",3,"title"],[1,"row"],[1,"col-sm-4","col-md-4","col-lg-3"],[1,"text-center"],["alt","user avatar","width","150","height","150",1,"m-b-8","r-full",3,"error","src"],[1,"m-t-0","m-b-8","f-w-400"],[1,"m-t-0","text-grey-500"],[1,"m-t-16","m-b-8"],["mat-list-item","","routerLink","/profile/overview"],["matListItemIcon",""],["mat-list-item","","tabindex","0",3,"click","keydown.enter"],[1,"col-sm-8","col-md-8","col-lg-9"]],template:function(i,t){i&1&&(v(0,"page-header",0),C(1,"translate"),r(2,"div",1)(3,"div",2)(4,"mat-card")(5,"mat-card-content")(6,"div",3)(7,"img",4),b("error",function(c){return t.onImageError(c)}),a(),r(8,"h2",5),m(9),a(),r(10,"p",6),m(11,"Let's make money."),a()(),v(12,"mat-divider",7),r(13,"mat-nav-list")(14,"a",8)(15,"mat-icon",9),m(16,"account_circle"),a(),m(17),C(18,"translate"),a(),r(19,"a",10),b("click",function(){return t.logout()})("keydown.enter",function(){return t.logout()}),r(20,"mat-icon",9),m(21,"exit_to_app"),a(),m(22),C(23,"translate"),a()()()()(),r(24,"div",11),v(25,"router-outlet"),a()()),i&2&&(mt("title",P(1,5,"profile")),o(7),p("src",t.avatarUrl,ce),o(2),h(t.user.username),o(8),k(" ",P(18,7,"profile")," "),o(5),k(" ",P(23,9,"logout")," "))},dependencies:[gt,ut,N,R,V,L,At,Et,Ft,Dt,Tt,Ut,z,K,yt,B,$],encapsulation:2})}}return n})();function Pi(n,l){if(n&1){let e=O();r(0,"img",20),b("error",function(t){x(e);let s=d();return w(s.onImageError(t))}),a()}if(n&2){let e=d();p("src",e.avatarPreviewUrl,ce)}}function Mi(n,l){n&1&&v(0,"mat-spinner",4)}function xi(n,l){if(n&1&&(r(0,"mat-error",7),m(1),a()),n&2){let e=d();o(),h(e.avatarError)}}function wi(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getErrorMessage("username"))}}function yi(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getErrorMessage("email"))}}function Oi(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getPasswordErrorMessage())}}function Si(n,l){if(n&1&&(r(0,"mat-option",16),m(1),a()),n&2){let e=l.$implicit;p("value",e),o(),h(e)}}function Ei(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getErrorMessage("estrategia"))}}function Ai(n,l){if(n&1&&(r(0,"mat-option",16),m(1),a()),n&2){let e=l.$implicit;p("value",e),o(),h(e)}}function Ii(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getErrorMessage("perfil"))}}function ki(n){let l=n.get("password"),e=n.get("confirmPassword");return!l||!e?null:!l.value&&!e.value?(e.setErrors(null),null):l.value!==e.value?(e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):(e.hasError("passwordMismatch")&&e.setErrors(null),null)}var di=(()=>{class n{constructor(){this.auth=_(j),this.fb=_(Oe),this.settingsService=_(ie),this.http=_(F),this.sanitizer=_(he),this.cdr=_(q),this.selectedFile=null,this.avatarPreviewUrl=null,this.avatarError=null,this.defaultAvatarPlaceholder="images/avatar.jpg",this.avatarObjectUrl=null,this.isLoadingAvatar=!0,this.perfilOptions=["Conservador","Intermedi\xE1rio","Agressivo"],this.estrategiaOptions=["Defensiva","Equilibrado","Ofensiva"],this.passwordVisibility={password:!1,confirmPassword:!1}}ngOnInit(){console.log("ProfileSettingsComponent: Initializing"),this.auth.user().pipe(se((e,i)=>e.id===i.id),le(e=>{console.log("ProfileSettingsComponent: User received",e),this.user=e,this.loadUserData(),this.loadAvatar(e.id)}),oe(100)).subscribe(),this.reactiveForm=this.fb.group({username:this.fb.control("",{validators:[U.required],nonNullable:!0}),email:this.fb.control("",{validators:[U.required,U.email],nonNullable:!0}),password:this.fb.control("",{nonNullable:!0}),confirmPassword:this.fb.control("",{nonNullable:!0}),estrategia:this.fb.control("",{validators:[U.required],nonNullable:!0}),perfil:this.fb.control("",{validators:[U.required],nonNullable:!0}),avatarIdentifier:this.fb.control(void 0),id:this.fb.control(void 0)},{validators:ki})}loadUserData(){console.log("ProfileSettingsComponent: Loading user data"),this.settingsService.getProfile().subscribe({next:e=>{e?(console.log("ProfileSettingsComponent: Profile data loaded",e),this.reactiveForm.patchValue({username:e.username,email:e.email,estrategia:e.estrategia,perfil:e.perfil,id:e.id,avatarIdentifier:e.avatarIdentifier})):(console.warn("ProfileSettingsComponent: No profile data loaded, using placeholder"),this.avatarPreviewUrl=this.defaultAvatarPlaceholder,this.isLoadingAvatar=!1,this.cdr.detectChanges())},error:e=>{console.error("ProfileSettingsComponent: Error loading profile data:",e),this.avatarPreviewUrl=this.defaultAvatarPlaceholder,this.isLoadingAvatar=!1,this.cdr.detectChanges()}})}loadAvatar(e){if(!e){console.warn("ProfileSettingsComponent: No user ID provided for avatar loading"),this.avatarPreviewUrl=this.defaultAvatarPlaceholder,this.isLoadingAvatar=!1,this.cdr.detectChanges();return}console.log("ProfileSettingsComponent: Fetching avatar for ID:",e);let i=`t=${Date.now()}`;this.http.get(`${S.baseUrl}/api/avatars/${e}?${i}`,{responseType:"blob"}).subscribe({next:t=>{console.log("ProfileSettingsComponent: Avatar loaded for ID:",e),this.avatarObjectUrl&&URL.revokeObjectURL(this.avatarObjectUrl),this.avatarObjectUrl=URL.createObjectURL(t),this.avatarPreviewUrl=this.sanitizer.bypassSecurityTrustUrl(this.avatarObjectUrl),this.isLoadingAvatar=!1,this.cdr.detectChanges()},error:t=>{console.warn("ProfileSettingsComponent: Failed to load avatar:",t),t.status===404?(console.log("ProfileSettingsComponent: Avatar not found (404), showing placeholder"),this.avatarPreviewUrl=this.defaultAvatarPlaceholder):(console.error("ProfileSettingsComponent: Unexpected error loading avatar:",t),this.avatarPreviewUrl=this.defaultAvatarPlaceholder),this.isLoadingAvatar=!1,this.cdr.detectChanges()}})}onFileSelected(e){console.log("ProfileSettingsComponent: File selected");let i=e.target;if(i.files&&i.files.length>0){let t=i.files[0];if(this.avatarError=null,!["image/jpeg","image/png"].includes(t.type)){this.avatarError="Apenas arquivos JPEG e PNG s\xE3o permitidos.",this.selectedFile=null,this.avatarPreviewUrl=this.defaultAvatarPlaceholder,i.value="",this.isLoadingAvatar=!1,this.cdr.detectChanges();return}let c=2*1024*1024;if(t.size>c){this.avatarError="O tamanho do arquivo n\xE3o pode exceder 2MB.",this.selectedFile=null,this.avatarPreviewUrl=this.defaultAvatarPlaceholder,i.value="",this.isLoadingAvatar=!1,this.cdr.detectChanges();return}this.selectedFile=t;let f=new FileReader;f.onload=()=>{this.avatarPreviewUrl=f.result,this.isLoadingAvatar=!1,this.cdr.detectChanges()},f.readAsDataURL(t)}else this.selectedFile=null,this.loadAvatar(this.user.id)}getErrorMessage(e){let i=this.reactiveForm.get(e);return!i||!i.touched?"":i.hasError("required")?"Este campo \xE9 obrigat\xF3rio.":i.hasError("email")?"Por favor, insira um e-mail v\xE1lido.":i.hasError("pattern")?"Por favor, insira uma URL v\xE1lida.":i.hasError("minlength")?"Deve ter no m\xEDnimo 20 caracteres.":i.hasError("invalidEndpoint")?"Endpoint inv\xE1lido ou indispon\xEDvel.":""}togglePasswordVisibility(e){this.passwordVisibility[e]=!this.passwordVisibility[e],this.cdr.detectChanges()}getPasswordErrorMessage(){let e=this.reactiveForm.get("confirmPassword");return!e||!e.touched?"":e.hasError("passwordMismatch")?"As senhas n\xE3o coincidem.":""}getAIKeyErrorMessage(e){let i=this.reactiveForm.get(e);return!i||!i.touched?"":i.hasError("required")?"API key \xE9 obrigat\xF3ria.":i.hasError("minlength")?"Deve ter no m\xEDnimo 20 caracteres.":i.hasError("pattern")?"Formato de API key inv\xE1lido.":""}onSubmit(){console.log("ProfileSettingsComponent: Submitting form"),this.reactiveForm.markAllAsTouched();let e=this.reactiveForm.get("password")?.value,i=this.reactiveForm.get("confirmPassword")?.value;if(e&&e.length>0){if(!i||i.length===0){this.reactiveForm.get("confirmPassword")?.setErrors({required:!0}),this.reactiveForm.get("confirmPassword")?.markAsTouched(),console.log("ProfileSettingsComponent: Confirma\xE7\xE3o de senha \xE9 obrigat\xF3ria");return}if(e!==i){this.reactiveForm.get("confirmPassword")?.setErrors({passwordMismatch:!0}),this.reactiveForm.get("confirmPassword")?.markAsTouched(),console.log("ProfileSettingsComponent: As senhas n\xE3o coincidem");return}}else this.reactiveForm.get("confirmPassword")?.setErrors(null);if(this.reactiveForm.invalid&&!this.selectedFile){console.log("ProfileSettingsComponent: Formul\xE1rio inv\xE1lido e nenhum arquivo selecionado");return}let t=new FormData,s=this.reactiveForm.getRawValue();t.append("username",s.username),t.append("email",s.email),t.append("estrategia",s.estrategia),t.append("perfil",s.perfil),s.password&&s.password.length>0&&t.append("password",s.password),this.selectedFile&&t.append("avatar",this.selectedFile,this.selectedFile.name),this.isLoadingAvatar=!0,this.cdr.detectChanges(),this.settingsService.updateProfile(t).subscribe({next:c=>{c?(console.log("ProfileSettingsComponent: Perfil atualizado com sucesso",c),alert("Perfil atualizado com sucesso!"),this.reactiveForm.patchValue({id:c.id,avatarIdentifier:c.avatarIdentifier}),c.id&&this.loadAvatar(c.id)):(console.error("ProfileSettingsComponent: Erro ao atualizar perfil: Resposta nula"),alert("Erro ao atualizar perfil"),this.loadAvatar(this.user.id)),this.selectedFile=null,this.reactiveForm.get("password")?.reset(""),this.reactiveForm.get("confirmPassword")?.reset(""),this.reactiveForm.markAsPristine(),this.reactiveForm.markAsUntouched(),this.cdr.detectChanges()},error:c=>{console.error("ProfileSettingsComponent: Erro ao atualizar perfil:",c),alert("Erro ao atualizar perfil"),this.loadAvatar(this.user.id),this.isLoadingAvatar=!1,this.cdr.detectChanges()}})}onImageError(e){console.warn("ProfileSettingsComponent: Image failed to load:",e.target.src),e.target.src=this.defaultAvatarPlaceholder,this.avatarPreviewUrl=this.defaultAvatarPlaceholder,this.isLoadingAvatar=!1,this.cdr.detectChanges()}ngOnDestroy(){console.log("ProfileSettingsComponent: Destroying"),this.avatarObjectUrl&&(URL.revokeObjectURL(this.avatarObjectUrl),this.avatarObjectUrl=null)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-profile-settings"]],features:[fe([ht(),ie])],decls:72,vars:51,consts:[["fileInput",""],[1,"form-field-full",3,"ngSubmit","formGroup"],[1,"avatar-section","m-b-16"],["alt","user avatar","width","130","height","130",1,"m-b-8","r-full",3,"src"],["diameter","40",1,"m-b-8"],["type","file","accept","image/jpeg,image/png",2,"display","none",3,"change"],["mat-stroked-button","","color","primary","type","button",3,"click"],[1,"m-t-8"],[1,"inputs-grid"],[1,"input-cell"],["matInput","","formControlName","username","required","",3,"placeholder"],["matInput","","formControlName","email","required","",3,"placeholder"],["matInput","","formControlName","password",3,"type","placeholder"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","confirmPassword",3,"type","placeholder"],["formControlName","estrategia","required",""],[3,"value"],["formControlName","perfil","required",""],[1,"save-button-container","m-t-16"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["alt","user avatar","width","130","height","130",1,"m-b-8","r-full",3,"error","src"]],template:function(i,t){if(i&1){let s=O();r(0,"mat-card")(1,"mat-card-content")(2,"form",1),b("ngSubmit",function(){return x(s),w(t.onSubmit())}),r(3,"div",2),g(4,Pi,1,1,"img",3)(5,Mi,1,0,"mat-spinner",4),r(6,"input",5,0),b("change",function(f){return x(s),w(t.onFileSelected(f))}),a(),r(8,"button",6),b("click",function(){x(s);let f=X(7);return w(f.click())}),m(9),C(10,"translate"),a(),g(11,xi,2,1,"mat-error",7),a(),r(12,"div",8)(13,"div",9)(14,"mat-form-field")(15,"mat-label"),m(16),C(17,"translate"),a(),v(18,"input",10),C(19,"translate"),g(20,wi,2,1,"mat-error"),a()(),r(21,"div",9)(22,"mat-form-field")(23,"mat-label"),m(24),C(25,"translate"),a(),v(26,"input",11),C(27,"translate"),g(28,yi,2,1,"mat-error"),a()(),r(29,"div",9)(30,"mat-form-field")(31,"mat-label"),m(32),C(33,"translate"),a(),v(34,"input",12),C(35,"translate"),r(36,"button",13),b("click",function(){return x(s),w(t.togglePasswordVisibility("password"))}),r(37,"mat-icon"),m(38),a()()()(),r(39,"div",9)(40,"mat-form-field")(41,"mat-label"),m(42),C(43,"translate"),a(),v(44,"input",14),C(45,"translate"),r(46,"button",13),b("click",function(){return x(s),w(t.togglePasswordVisibility("confirmPassword"))}),r(47,"mat-icon"),m(48),a()(),g(49,Oi,2,1,"mat-error"),a()(),r(50,"div",9)(51,"mat-form-field")(52,"mat-label"),m(53),C(54,"translate"),a(),r(55,"mat-select",15),Le(56,Si,2,2,"mat-option",16,Ve),a(),g(58,Ei,2,1,"mat-error"),a()(),r(59,"div",9)(60,"mat-form-field")(61,"mat-label"),m(62),C(63,"translate"),a(),r(64,"mat-select",17),Le(65,Ai,2,2,"mat-option",16,Ve),a(),g(67,Ii,2,1,"mat-error"),a()()(),r(68,"div",18)(69,"button",19),m(70),C(71,"translate"),a()()()()()}if(i&2){let s,c,f,u,M;o(2),p("formGroup",t.reactiveForm),o(2),y(t.isLoadingAvatar?5:4),o(5),k(" ",P(10,27,"settings.update_avatar")," "),o(2),y(t.avatarError?11:-1),o(5),h(P(17,29,"settings.fields.name")),o(2),p("placeholder",P(19,31,"settings.placeholders.name")),o(2),y((s=t.reactiveForm.get("username"))!=null&&s.invalid&&((s=t.reactiveForm.get("username"))!=null&&s.touched)?20:-1),o(4),h(P(25,33,"settings.fields.email")),o(2),p("placeholder",P(27,35,"settings.placeholders.email")),o(2),y((c=t.reactiveForm.get("email"))!=null&&c.invalid&&((c=t.reactiveForm.get("email"))!=null&&c.touched)?28:-1),o(4),h(P(33,37,"settings.fields.password")),o(2),p("type",t.passwordVisibility.password?"text":"password")("placeholder",P(35,39,"settings.placeholders.new_password_optional")),o(2),T("aria-label",t.passwordVisibility.password?"Ocultar senha":"Mostrar senha"),o(2),h(t.passwordVisibility.password?"visibility_off":"visibility"),o(4),h(P(43,41,"settings.fields.confirm_password")),o(2),p("type",t.passwordVisibility.confirmPassword?"text":"password")("placeholder",P(45,43,"settings.placeholders.confirm_password")),o(2),T("aria-label",t.passwordVisibility.confirmPassword?"Ocultar senha":"Mostrar senha"),o(2),h(t.passwordVisibility.confirmPassword?"visibility_off":"visibility"),o(),y((f=t.reactiveForm.get("confirmPassword"))!=null&&f.invalid&&((f=t.reactiveForm.get("confirmPassword"))!=null&&f.touched)?49:-1),o(4),h(P(54,45,"settings.fields.strategy")),o(3),Re(t.estrategiaOptions),o(2),y((u=t.reactiveForm.get("estrategia"))!=null&&u.invalid&&((u=t.reactiveForm.get("estrategia"))!=null&&u.touched)?58:-1),o(4),h(P(63,47,"settings.fields.profile")),o(3),Re(t.perfilOptions),o(2),y((M=t.reactiveForm.get("perfil"))!=null&&M.invalid&&((M=t.reactiveForm.get("perfil"))!=null&&M.touched)?67:-1),o(2),p("disabled",t.reactiveForm.invalid&&!t.selectedFile),o(),k(" ",P(71,49,"common.save")," ")}},dependencies:[D,Se,xe,Ce,Pe,Me,Ct,Ee,we,ye,N,ve,Z,R,V,L,J,Y,W,be,Q,te,ee,z,K,Te,Ue,Ae,Pt,vt,B,$],styles:['@charset "UTF-8";.avatar-preview[_ngcontent-%COMP%]{width:150px;height:150px;object-fit:cover;border:2px solid #ccc;border-radius:40%;box-shadow:0 2px 4px #0000001a}.m-b-8[_ngcontent-%COMP%]{margin-bottom:8px}.m-b-16[_ngcontent-%COMP%]{margin-bottom:16px}.m-t-8[_ngcontent-%COMP%]{margin-top:8px}.m-t-16[_ngcontent-%COMP%]{margin-top:16px}.d-flex[_ngcontent-%COMP%]{display:flex}.flex-column[_ngcontent-%COMP%]{flex-direction:column}.align-items-center[_ngcontent-%COMP%]{align-items:center}.justify-content-center[_ngcontent-%COMP%]{justify-content:center}[_nghost-%COMP%]   .form-grid-row[_ngcontent-%COMP%]{gap:12px 8px}[_nghost-%COMP%]   .form-grid-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   form.form-field-full[_ngcontent-%COMP%]   .form-grid-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}@media (width <= 600px){[_nghost-%COMP%]   form.form-field-full[_ngcontent-%COMP%]   .form-grid-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}}[_nghost-%COMP%]   .avatar-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .save-button-container[_ngcontent-%COMP%]{display:flex;justify-content:center}[_nghost-%COMP%]   form.form-field-full[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}[_nghost-%COMP%]   .avatar-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .inputs-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px 16px}[_nghost-%COMP%]   .input-cell[_ngcontent-%COMP%]{display:flex;justify-content:center}[_nghost-%COMP%]   .inputs-grid[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:80%}mat-card[_ngcontent-%COMP%], .mat-mdc-card[_ngcontent-%COMP%], .mdc-card[_ngcontent-%COMP%], .mat-mdc-card-outlined[_ngcontent-%COMP%], .mdc-card--outlined[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important}mat-card[_ngcontent-%COMP%]:hover, .mat-mdc-card[_ngcontent-%COMP%]:hover{box-shadow:none!important;transform:none!important}mat-card-content[_ngcontent-%COMP%], .mat-mdc-card-content[_ngcontent-%COMP%]{background:transparent!important}']})}}return n})();function Ui(n,l){n&1&&v(0,"div",2)}var Ti=new et("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var ui=(()=>{class n{_elementRef=_(nt);_ngZone=_(it);_changeDetectorRef=_(q);_renderer=_(de);_cleanupTransitionEnd;_animationMode=_(at,{optional:!0});constructor(){let e=_(Ti,{optional:!0});this._isNoopAnimation=this._animationMode==="NoopAnimations",e&&(e.color&&(this.color=this._defaultColor=e.color),this.mode=e.mode||this.mode)}_isNoopAnimation=!1;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";get value(){return this._value}set value(e){this._value=pi(e||0),this._changeDetectorRef.markForCheck()}_value=0;get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=pi(e||0),this._changeDetectorRef.markForCheck()}_bufferValue=0;animationEnd=new tt;get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}_mode="determinate";ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._cleanupTransitionEnd=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._transitionendHandler)})}ngOnDestroy(){this._cleanupTransitionEnd?.()}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}_transitionendHandler=e=>{this.animationEnd.observers.length===0||!e.target||!e.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))};static \u0275fac=function(i){return new(i||n)};static \u0275cmp=E({type:n,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(i,t){i&2&&(T("aria-valuenow",t._isIndeterminate()?null:t.value)("mode",t.mode),ot("mat-"+t.color),G("_mat-animation-noopable",t._isNoopAnimation)("mdc-linear-progress--animation-ready",!t._isNoopAnimation)("mdc-linear-progress--indeterminate",t._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",je],bufferValue:[2,"bufferValue","bufferValue",je],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[ue],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(i,t){i&1&&(r(0,"div",0),v(1,"div",1),g(2,Ui,1,0,"div",2),a(),r(3,"div",3),v(4,"span",4),a(),r(5,"div",5),v(6,"span",4),a()),i&2&&(o(),Fe("flex-basis",t._getBufferBarFlexBasis()),o(),y(t.mode==="buffer"?2:-1),o(),Fe("transform",t._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height, 4px),var(--mdc-linear-progress-active-indicator-height, 4px))}@media(forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height, 4px);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-sys-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}@media(forced-colors: active){.mdc-linear-progress__buffer-dots{background-color:ButtonBorder}}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height, 4px) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0})}return n})();function pi(n,l=0,e=100){return Math.max(l,Math.min(e,n))}var fi=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=pe({type:n});static \u0275inj=me({imports:[_t]})}return n})();var Di=["*"];function Fi(n,l){n&1&&v(0,"div",0)}function Vi(n,l){if(n&1&&v(0,"mat-spinner",2),n&2){let e=d(2);p("color",e.color)("strokeWidth",e.strokeWidth)("diameter",e.diameter)("mode",e.mode)("value",e.value)}}function Li(n,l){if(n&1&&v(0,"mat-progress-bar",3),n&2){let e=d(2);p("color",e.color)("mode",e.mode)("value",e.value)("bufferValue",e.bufferValue)}}function Ri(n,l){if(n&1&&(r(0,"div",1),g(1,Vi,1,5,"mat-spinner",2)(2,Li,1,4,"mat-progress-bar",3),a()),n&2){let e=d();o(),y(e.type==="spinner"?1:-1),o(),y(e.type==="progressbar"?2:-1)}}var Ni=(()=>{class n{constructor(){this._changeDetectorRef=_(q),this.type="spinner",this.color="primary",this.mode="indeterminate",this.strokeWidth=4,this.diameter=48,this.bufferValue=0,this.value=0,this.loading=!0,this.hasBackdrop=!0}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=E({type:n,selectors:[["mtx-loader"]],hostAttrs:[1,"mtx-loader"],hostVars:2,hostBindings:function(i,t){i&2&&G("mtx-loader-loading",t.loading)},inputs:{type:"type",color:"color",mode:"mode",strokeWidth:"strokeWidth",diameter:"diameter",bufferValue:"bufferValue",value:"value",loading:[2,"loading","loading",ze],hasBackdrop:[2,"hasBackdrop","hasBackdrop",ze]},exportAs:["mtxLoader"],features:[ue],ngContentSelectors:Di,decls:3,vars:2,consts:[[1,"mtx-loader-backdrop"],[1,"mtx-loader-main"],[3,"color","strokeWidth","diameter","mode","value"],[3,"color","mode","value","bufferValue"]],template:function(i,t){i&1&&(st(),g(0,Fi,1,0,"div",0)(1,Ri,3,2,"div",1),lt(2)),i&2&&(y(t.loading&&t.hasBackdrop?0:-1),o(),y(t.loading?1:-1))},dependencies:[Ue,ui],styles:[`.mtx-loader{position:relative;display:block;width:100%;height:100%}.mtx-loader-main{position:absolute;top:0;left:0;z-index:210;display:flex;justify-content:center;align-items:center;width:100%;height:100%}.mtx-loader-main .mat-mdc-spinner{position:relative}.mtx-loader-main .mat-mdc-progress-bar{position:absolute;top:0;left:0;width:100%}.mtx-loader-backdrop{position:absolute;top:0;left:0;z-index:200;display:block;width:100%;height:100%;content:"";background-color:var(--mtx-loader-backdrop-background-color, color-mix(in srgb, var(--mat-sys-surface) 75%, transparent))}
`],encapsulation:2,changeDetection:0})}}return n})(),gi=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=pe({type:n})}static{this.\u0275inj=me({imports:[D,Te,fi,Ni]})}}return n})();function Bi(n,l){n&1&&(r(0,"mtx-alert",17),m(1,"Nenhuma chave v\xE1lida encontrada."),a())}function Ki(n,l){n&1&&(r(0,"mtx-alert",18),m(1," Autenticando no provedor selecionado... "),a())}function zi(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getAIKeyErrorMessage("openaiApiKey"))}}function ji(n,l){if(n&1&&(r(0,"mat-error"),m(1),a()),n&2){let e=d();o(),h(e.getAIKeyErrorMessage("geminiApiKey"))}}var _i=(()=>{class n{constructor(){this.fb=_(Oe),this.settingsService=_(ie),this.http=_(F),this.auth=_(j),this.storage=_(Ot),this.userId=null,this.llmKeys={},this.hasValidGemini=!1,this.hasValidOpenAI=!1,this.isLoginLoading=!1,this.formSubmitted=!1,this.showGeminiKey=!1,this.showOpenAIKey=!1,this.messageHandler=e=>this.onPopupMessage(e),this.oauthPopup=null}ngOnInit(){this.aiForm=this.fb.group({openaiApiKey:this.fb.control("",{nonNullable:!0}),geminiApiKey:this.fb.control("",{nonNullable:!0})});let e=this.aiForm.get("geminiApiKey"),i=this.aiForm.get("openaiApiKey");e?.setValidators([U.pattern(/^AIza[0-9A-Za-z-_]{20,40}$/)]),i?.setValidators([U.pattern(/^sk-[A-Za-z0-9-]{20,}$/)]),this.aiForm.patchValue({openaiApiKey:"",geminiApiKey:""});let t=this.auth.getCurrentUserValue?.()??null;this.userId=(t&&t.id)??null,window.addEventListener("message",this.messageHandler),this.fetchLlmKeys()}ngOnDestroy(){window.removeEventListener("message",this.messageHandler)}getAIKeyErrorMessage(e){let i=this.aiForm.get(e),t=i?.value||"";return typeof t=="string"&&t.includes("...")||!i||!i.touched?"":i.hasError("required")?"API key \xE9 obrigat\xF3ria.":i.hasError("pattern")?"Formato de API key inv\xE1lido.":""}onSubmit(){if(this.formSubmitted=!0,this.aiForm.markAllAsTouched(),this.aiForm.invalid)return;let e=this.aiForm.get("openaiApiKey")?.value?.trim()||"",i=this.aiForm.get("geminiApiKey")?.value?.trim()||"",t=[];if(this.userId&&e&&/^sk-[A-Za-z0-9-]{20,}$/.test(e)){let u={provider:"openai",apiKey:e};this.llmKeys.openai?t.push(this.http.put(`/api/usuarios/${this.userId}/llm/keys`,u)):t.push(this.http.post(`/api/usuarios/${this.userId}/llm/keys`,u))}if(this.userId&&i&&/^AIza[0-9A-Za-z-_]{20,40}$/.test(i)){let u={provider:"gemini",apiKey:i};this.llmKeys.gemini?t.push(this.http.put(`/api/usuarios/${this.userId}/llm/keys`,u)):t.push(this.http.post(`/api/usuarios/${this.userId}/llm/keys`,u))}if(t.length===0){alert("Preencha ao menos uma chave v\xE1lida para salvar.");return}let s=()=>this.aiForm.patchValue({openaiApiKey:"",geminiApiKey:""}),c=()=>{s(),this.fetchLlmKeys(),alert("Chaves de AI atualizadas com sucesso.")},f=u=>{this.fetchLlmKeys(),alert(u||"Falha ao salvar no servidor. As chaves foram armazenadas localmente para uso tempor\xE1rio.")};t.length===1?t[0].subscribe({next:()=>c(),error:u=>{let M=typeof u?.error=="string"?u.error:u?.message||"Falha ao salvar no servidor.";f(M)}}):t[0].pipe(Je(()=>t[1])).subscribe({next:()=>c(),error:u=>{let M=typeof u?.error=="string"?u.error:u?.message||"Falha ao salvar no servidor.";f(M)}})}toggleKeyVisibility(e){e==="gemini"?this.showGeminiKey=!this.showGeminiKey:this.showOpenAIKey=!this.showOpenAIKey}clearKey(e){e==="openai"?this.aiForm.get("openaiApiKey")?.setValue(""):this.aiForm.get("geminiApiKey")?.setValue("")}openGeminiPortal(){window.open("https://ai.google.dev/gemini-api/docs/api-key","_blank")}openOpenAIPortal(){window.open("https://platform.openai.com/settings/organization/api-keys","_blank")}fetchLlmKeys(){if(!this.userId){this.hasValidOpenAI=!1,this.hasValidGemini=!1,this.aiForm.patchValue({openaiApiKey:"",geminiApiKey:""});return}this.http.get(`/api/usuarios/${this.userId}/llm/keys`).pipe(Ye(()=>Qe(null))).subscribe(e=>{let i=e||{},t=i?.gemini,s=i?.openai,c=i?.geminiKeyMasked,f=i?.openaiKeyMasked,u=typeof t=="boolean"?t:this.validateKey("gemini",t||"");console.log(`fetchLlmKeys - backendGeminiValid: ${u}`);let M=typeof s=="boolean"?s:this.validateKey("openai",s||"");this.llmKeys={gemini:u,openai:M},this.hasValidGemini=this.llmKeys.gemini||!1,console.log(`fetchLlmKeys - this.hasValidGemini (after assignment): ${this.hasValidGemini}`),this.hasValidOpenAI=this.llmKeys.openai||!1;let H=typeof f=="string"&&f?f:typeof s=="string"?s:"",De=typeof c=="string"&&c?c:typeof t=="string"?t:"";this.aiForm.patchValue({openaiApiKey:H,geminiApiKey:De});let qe=this.aiForm.get("openaiApiKey"),Ze=this.aiForm.get("geminiApiKey")})}validateKey(e,i){if(console.log(`validateKey called for provider: ${e}, key: ${i}`),!i||typeof i!="string")return console.log(`validateKey - Invalid key type or empty for ${e}`),!1;if(i.includes("..."))return console.log(`validateKey - Key for ${e} is masked, returning true.`),!0;if(e==="gemini"){let t=/^AIza[0-9A-Za-z-_]{20,40}$/.test(i);return console.log(`validateKey - Gemini key validation result: ${t}`),t}if(e==="openai"){let t=/^sk-[A-Za-z0-9-]{20,}$/.test(i);return console.log(`validateKey - OpenAI key validation result: ${t}`),t}return console.log(`validateKey - Unknown provider: ${e}, returning false.`),!1}loginWithProvider(e){}onPopupMessage(e){try{let i=e.data||{};if(!i||i.type!=="llm-auth")return;this.isLoginLoading=!1}catch{this.isLoginLoading=!1}}isInvalid(e){let i=this.aiForm.get(e),t=i?.value||"";return typeof t=="string"&&t.includes("...")?!1:!!i?.invalid}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-ai-settings"]],features:[fe([ie])],decls:45,vars:33,consts:[[1,"text-center"],[1,"form-field-full",3,"ngSubmit","formGroup"],[1,"row","form-grid-row"],[1,"col-12"],["type","warning","class","m-b-8",4,"ngIf"],["type","info","class","m-b-8",4,"ngIf"],[1,"col-6","m-b-16"],[1,"status-container"],["color","primary","aria-readonly","true",1,"status-toggle",3,"checked","disabled","tabindex"],["appearance","outline",1,"w-100"],["matInput","","placeholder","sk-...","formControlName","openaiApiKey",3,"type"],["matSuffix","",1,"mat-form-field-suffix-wrapper"],["mat-icon-button","","type","button",3,"click"],["appearance","outline"],["matInput","","formControlName","geminiApiKey",3,"type","placeholder"],[1,"save-button-container","m-t-16"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["type","warning",1,"m-b-8"],["type","info",1,"m-b-8"]],template:function(i,t){if(i&1&&(r(0,"mat-card")(1,"h2",0),m(2,"Integra\xE7\xF5es LLM"),a(),r(3,"mat-card-content")(4,"form",1),b("ngSubmit",function(){return t.onSubmit()}),r(5,"div",2)(6,"div",3),g(7,Bi,2,0,"mtx-alert",4)(8,Ki,2,0,"mtx-alert",5),a(),r(9,"div",6)(10,"h4"),m(11,"OpenAI"),a(),r(12,"div",7)(13,"mat-slide-toggle",8),m(14),a()(),r(15,"mat-form-field",9)(16,"mat-label"),m(17,"OpenAI API Key"),a(),v(18,"input",10),r(19,"div",11)(20,"button",12),b("click",function(){return t.toggleKeyVisibility("openai")}),r(21,"mat-icon"),m(22),a()()(),g(23,zi,2,1,"mat-error"),a()(),r(24,"div",6)(25,"h4"),m(26,"Gemini"),a(),r(27,"div",7)(28,"mat-slide-toggle",8),m(29),a()(),r(30,"mat-form-field",13)(31,"mat-label"),m(32),C(33,"translate"),a(),v(34,"input",14),C(35,"translate"),r(36,"div",11)(37,"button",12),b("click",function(){return t.toggleKeyVisibility("gemini")}),r(38,"mat-icon"),m(39),a()()(),g(40,ji,2,1,"mat-error"),a()()(),r(41,"div",15)(42,"button",16),m(43),C(44,"translate"),a()()()()()),i&2){let s,c;o(4),p("formGroup",t.aiForm),o(3),p("ngIf",!t.hasValidGemini&&!t.hasValidOpenAI),o(),p("ngIf",t.isLoginLoading),o(5),p("checked",t.hasValidOpenAI)("disabled",!0)("tabindex",-1),o(),k(" OpenAI ",t.hasValidOpenAI?"dispon\xEDvel":"indispon\xEDvel"," "),o(),G("invalid-field",t.isInvalid("openaiApiKey")),o(3),p("type",t.showOpenAIKey?"text":"password"),o(2),T("aria-label",t.showOpenAIKey?"Ocultar chave":"Exibir chave"),o(2),h(t.showOpenAIKey?"visibility_off":"visibility"),o(),y((s=t.aiForm.get("openaiApiKey"))!=null&&s.invalid&&t.formSubmitted?23:-1),o(5),p("checked",t.hasValidGemini)("disabled",!0)("tabindex",-1),o(),k(" Gemini ",t.hasValidGemini?"dispon\xEDvel":"indispon\xEDvel"," "),o(),G("invalid-field",t.isInvalid("geminiApiKey")),o(2),h(P(33,27,"settings.ai.gemini_api_key")),o(2),p("type",t.showGeminiKey?"text":"password")("placeholder",P(35,29,"settings.ai.placeholders.gemini_api_key")),o(3),T("aria-label",t.showGeminiKey?"Ocultar chave":"Exibir chave"),o(2),h(t.showGeminiKey?"visibility_off":"visibility"),o(),y((c=t.aiForm.get("geminiApiKey"))!=null&&c.invalid&&t.formSubmitted?40:-1),o(2),p("disabled",t.aiForm.invalid),o(),k(" ",P(44,31,"common.save")," ")}},dependencies:[D,_e,Se,xe,Ce,Pe,Me,Ee,we,ye,R,V,L,J,Y,W,be,Q,te,ee,Ae,N,ve,Z,z,K,kt,It,B,$,ti,ei,gi,oi],styles:["mat-card[_ngcontent-%COMP%], .mat-mdc-card[_ngcontent-%COMP%], .mdc-card[_ngcontent-%COMP%], .mat-mdc-card-outlined[_ngcontent-%COMP%], .mdc-card--outlined[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important}mat-card-content[_ngcontent-%COMP%], .mat-mdc-card-content[_ngcontent-%COMP%]{padding:32px 16px;background:transparent!important}.invalid-field[_ngcontent-%COMP%]   .mdc-notched-outline__leading[_ngcontent-%COMP%], .invalid-field[_ngcontent-%COMP%]   .mdc-notched-outline__trailing[_ngcontent-%COMP%], .invalid-field[_ngcontent-%COMP%]   .mdc-notched-outline__notch[_ngcontent-%COMP%]{border-color:var(--mat-sys-error)!important}.status-container[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;margin-bottom:32px}.status-toggle[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}.form-grid-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:32px}.save-button-container[_ngcontent-%COMP%]{margin-top:32px;text-align:center}.form-grid-row[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:32px}.form-grid-row[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding:10px 0}.status-toggle.mat-checked[_ngcontent-%COMP%]   .mat-slide-toggle-bar[_ngcontent-%COMP%]{background-color:green!important}.status-toggle.mat-checked[_ngcontent-%COMP%]   .mat-slide-toggle-thumb[_ngcontent-%COMP%]{background-color:#006400!important}.mat-form-field-suffix-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.mat-form-field-suffix-wrapper[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{height:24px;width:24px;line-height:24px}.mat-form-field-suffix-wrapper[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px}"]})}}return n})();var Gi=()=>[5];function Hi(n,l){n&1&&(r(0,"th",31),m(1,"ID"),a())}function Xi(n,l){if(n&1&&(r(0,"td",32),m(1),a()),n&2){let e=l.$implicit;o(),h(e.id)}}function qi(n,l){n&1&&(r(0,"th",31),m(1,"Username"),a())}function Zi(n,l){if(n&1){let e=O();r(0,"input",35),b("input",function(t){x(e);let s=d(3);return w(s.onEditField("username",t.target.value))}),a()}if(n&2){let e,i=d(3);p("value",(e=i.editingUser==null?null:i.editingUser.username)!==null&&e!==void 0?e:"")}}function Wi(n,l){if(n&1&&(r(0,"span"),m(1),a()),n&2){let e=d().$implicit;o(),h(e.username)}}function Qi(n,l){if(n&1&&(r(0,"td",32),g(1,Zi,1,1,"input",33)(2,Wi,2,1,"span",34),a()),n&2){let e=l.$implicit,i=d(2);o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)===e.id),o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)!==e.id)}}function Yi(n,l){n&1&&(r(0,"th",31),m(1,"Email"),a())}function Ji(n,l){if(n&1){let e=O();r(0,"input",35),b("input",function(t){x(e);let s=d(3);return w(s.onEditField("email",t.target.value))}),a()}if(n&2){let e,i=d(3);p("value",(e=i.editingUser==null?null:i.editingUser.email)!==null&&e!==void 0?e:"")}}function en(n,l){if(n&1&&(r(0,"span"),m(1),a()),n&2){let e=d().$implicit;o(),h(e.email)}}function tn(n,l){if(n&1&&(r(0,"td",32),g(1,Ji,1,1,"input",33)(2,en,2,1,"span",34),a()),n&2){let e=l.$implicit,i=d(2);o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)===e.id),o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)!==e.id)}}function nn(n,l){n&1&&(r(0,"th",31),m(1,"Roles"),a())}function rn(n,l){if(n&1&&(r(0,"td",32),m(1),a()),n&2){let e=l.$implicit,i=d(2);o(),h(i.formatRoles(e.roles))}}function an(n,l){n&1&&(r(0,"th",31),m(1,"\xDAltimo login"),a())}function on(n,l){if(n&1&&(r(0,"td",32),m(1),C(2,"date"),a()),n&2){let e=l.$implicit;o(),h(e.lastLogin?ge(2,1,e.lastLogin,"dd/MM/yyyy HH:mm"):"\u2014")}}function sn(n,l){n&1&&(r(0,"th",31),m(1,"Data de cadastro"),a())}function ln(n,l){if(n&1&&(r(0,"td",32),m(1),C(2,"date"),a()),n&2){let e=l.$implicit;o(),h(e.createdAt?ge(2,1,e.createdAt,"dd/MM/yyyy HH:mm"):"\u2014")}}function mn(n,l){n&1&&(r(0,"th",31),m(1,"Premium expira"),a())}function cn(n,l){if(n&1&&(A(0),m(1),C(2,"date"),I()),n&2){let e=d().$implicit;o(),k(" ",e.premiumUntil?ge(2,1,e.premiumUntil,"dd/MM/yyyy"):"\u2014"," ")}}function dn(n,l){if(n&1){let e=O();r(0,"div",37)(1,"mat-form-field",38)(2,"input",39),b("dateChange",function(t){x(e);let s=d(3);return w(s.premiumUntilInput=t.value)}),a(),v(3,"mat-datepicker-toggle",40)(4,"mat-datepicker",null,1),a(),r(6,"div",41)(7,"button",42),b("click",function(){x(e);let t=d().$implicit,s=d(2);return w(s.confirmActivatePremium(t))}),r(8,"mat-icon"),m(9,"save"),a()(),r(10,"button",43),b("click",function(){x(e);let t=d(3);return w(t.cancelActivatePremium())}),r(11,"mat-icon"),m(12,"close"),a()()()()}if(n&2){let e=X(5),i=d(3);o(2),p("matDatepicker",e)("value",i.premiumUntilInput),o(),p("for",e)}}function pn(n,l){if(n&1&&(r(0,"td",32),g(1,cn,3,4,"ng-container",36)(2,dn,13,3,"ng-template",null,0,Ke),a()),n&2){let e=l.$implicit,i=X(3),t=d(2);o(),p("ngIf",t.premiumActivationId!==e.id)("ngIfElse",i)}}function un(n,l){n&1&&(r(0,"th",44),m(1,"Premium"),a())}function fn(n,l){if(n&1){let e=O();A(0),r(1,"div",45)(2,"button",46),b("click",function(){x(e);let t=d().$implicit,s=d(2);return w(s.startActivatePremium(t))}),r(3,"mat-icon"),m(4,"verified"),a()(),r(5,"button",47),b("click",function(){x(e);let t=d().$implicit,s=d(2);return w(s.deactivatePremium(t))}),r(6,"mat-icon"),m(7,"block"),a()()(),I()}}function gn(n,l){}function _n(n,l){if(n&1&&(r(0,"td",32),g(1,fn,8,0,"ng-container",36)(2,gn,0,0,"ng-template",null,2,Ke),a()),n&2){let e=l.$implicit,i=X(3),t=d(2);o(),p("ngIf",t.premiumActivationId!==e.id)("ngIfElse",i)}}function hn(n,l){n&1&&(r(0,"th",44),m(1,"A\xE7\xF5es"),a())}function vn(n,l){if(n&1){let e=O();r(0,"button",53),b("click",function(){x(e);let t=d().$implicit,s=d(2);return w(s.startEdit(t))}),r(1,"mat-icon"),m(2,"edit"),a()()}}function bn(n,l){if(n&1){let e=O();r(0,"button",54),b("click",function(){x(e);let t=d(3);return w(t.saveEdit())}),r(1,"mat-icon"),m(2,"save"),a()()}}function Cn(n,l){if(n&1){let e=O();r(0,"button",55),b("click",function(){x(e);let t=d(3);return w(t.cancelEdit())}),r(1,"mat-icon"),m(2,"close"),a()()}}function Pn(n,l){if(n&1){let e=O();r(0,"button",56),b("click",function(){x(e);let t=d().$implicit,s=d(2);return w(s.deleteUser(t))}),r(1,"mat-icon"),m(2,"delete"),a()()}}function Mn(n,l){if(n&1){let e=O();r(0,"td",32),g(1,vn,3,0,"button",48)(2,bn,3,0,"button",49)(3,Cn,3,0,"button",50),r(4,"button",51),b("click",function(){let t=x(e).$implicit,s=d(2);return w(s.resetPassword(t))}),r(5,"mat-icon"),m(6,"vpn_key"),a()(),g(7,Pn,3,0,"button",52),a()}if(n&2){let e=l.$implicit,i=d(2);o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)!==e.id),o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)===e.id),o(),p("ngIf",(i.editingUser==null?null:i.editingUser.id)===e.id),o(4),p("ngIf",(i.editingUser==null?null:i.editingUser.id)!==e.id)}}function xn(n,l){n&1&&v(0,"tr",57)}function wn(n,l){n&1&&v(0,"tr",58)}function yn(n,l){if(n&1){let e=O();r(0,"mat-tab",9)(1,"div",6)(2,"mat-card",10)(3,"mat-card-content")(4,"div",11)(5,"mat-form-field",12)(6,"mat-label"),m(7,"Buscar usu\xE1rios"),a(),r(8,"input",13),b("keyup",function(t){x(e);let s=d();return w(s.applyFilter(t.target.value))}),a()()(),r(9,"div",14)(10,"table",15),A(11,16),g(12,Hi,2,0,"th",17)(13,Xi,2,1,"td",18),I(),A(14,19),g(15,qi,2,0,"th",17)(16,Qi,3,2,"td",18),I(),A(17,20),g(18,Yi,2,0,"th",17)(19,tn,3,2,"td",18),I(),A(20,21),g(21,nn,2,0,"th",17)(22,rn,2,1,"td",18),I(),A(23,22),g(24,an,2,0,"th",17)(25,on,3,4,"td",18),I(),A(26,23),g(27,sn,2,0,"th",17)(28,ln,3,4,"td",18),I(),A(29,24),g(30,mn,2,0,"th",17)(31,pn,4,2,"td",18),I(),A(32,25),g(33,un,2,0,"th",26)(34,_n,4,2,"td",18),I(),A(35,27),g(36,hn,2,0,"th",26)(37,Mn,8,4,"td",18),I(),g(38,xn,1,0,"tr",28)(39,wn,1,0,"tr",29),a()(),v(40,"mat-paginator",30),a()()()()}if(n&2){let e=d();o(8),p("value",e.searchValue),o(2),p("dataSource",e.usersDataSource),o(28),p("matHeaderRowDef",e.displayedColumns),o(),p("matRowDefColumns",e.displayedColumns),o(),p("pageSize",5)("pageSizeOptions",ct(6,Gi))}}var hi=(()=>{class n{constructor(){this.authService=_(j),this.platformId=_(rt),this.renderer=_(de),this.settings=_(St),this.http=_(F),this.usersDataSource=new Qt([]),this.displayedColumns=["id","username","email","roles","lastLogin","createdAt","premiumUntil","premium","actions"],this.editingUser=null,this.selectedUserId=null,this.searchValue="",this.pageSize=5,this.totalUsers=0,this.loadingUsers=!1,this.pageIndex=0,this.sortActive="",this.sortDirection="",this.premiumActivationId=null,this.premiumUntilInput=null}ngOnInit(){this.isAdmin&&(this.usersDataSource.filterPredicate=(e,i)=>{let t=(i||"").toLowerCase(),s=String(e?.id??"").toLowerCase(),c=String(e?.username??"").toLowerCase(),f=String(e?.email??"").toLowerCase(),u=Array.isArray(e?.roles)?e.roles.map(M=>String(typeof M=="string"?M:M?.name??M?.role??M?.id??"")).join(",").toLowerCase():String(e?.roles??"").toLowerCase();return s.includes(t)||c.includes(t)||f.includes(t)||u.includes(t)},this.loadAllUsers())}ngAfterViewInit(){this.isAdmin&&(this.usersDataSource.paginator=this.paginator,this.usersDataSource.sort=this.sort)}ngOnDestroy(){}get isAdmin(){let i=this.authService.getCurrentUserValue()?.roles;return!i||!Array.isArray(i)?!1:i.some(t=>{if(typeof t=="string")return t.toUpperCase()==="ADMIN";let s=t?.name||t?.role||t?.id||"";return String(s).toUpperCase()==="ADMIN"})}formatRoles(e){if(e==null)return"";if(Array.isArray(e))return e.map(i=>{let t=typeof i=="string"?i:i?.name??i?.role??i?.id??"";return String(t)}).filter(i=>i&&i.length>0).join(", ");if(typeof e=="string")return e;if(typeof e=="object"){let i=e?.name??e?.role??e?.id??"";return String(i)}return String(e)}startEdit(e){this.editingUser=ne({},e)}cancelEdit(){this.editingUser=null}onEditField(e,i){this.editingUser&&(this.editingUser[e]=i)}saveEdit(){if(!this.editingUser||!this.editingUser.id)return;let e=this.editingUser.id,t=`${`${S.baseUrl||""}/api`}/usuarios/${e}`,s=new FormData;s.append("username",String(this.editingUser.username??"")),s.append("email",String(this.editingUser.email??"")),this.http.put(t,s).subscribe({next:c=>{let f=this.usersDataSource.data.map(u=>u.id===e?c:u);this.usersDataSource.data=f,this.editingUser=null},error:c=>{console.error("Erro ao atualizar usu\xE1rio",c)}})}activatePremium(e){if(!e?.id)return;let i=e.id,t=`${S.baseUrl||""}/api`;this.http.post(`${t}/usuarios/${i}/assinatura/premium/ativar`,{}).subscribe({next:()=>{this.isAdmin?this.loadAllUsers():this.loadCurrentUser()},error:s=>{console.error("Erro ao ativar premium",s)}})}deactivatePremium(e){if(!e?.id)return;let i=e.id,t=`${S.baseUrl||""}/api`;this.http.post(`${t}/usuarios/${i}/assinatura/premium/desativar`,{}).subscribe({next:()=>{this.isAdmin?this.loadAllUsers():this.loadCurrentUser()},error:s=>{console.error("Erro ao desativar premium",s)}})}startActivatePremium(e){this.premiumActivationId=e?.id??null,this.premiumUntilInput=e?.premiumUntil?new Date(e.premiumUntil):null}cancelActivatePremium(){this.premiumActivationId=null,this.premiumUntilInput=null}confirmActivatePremium(e){if(!e?.id)return;let i=e.id,t={};this.premiumUntilInput instanceof Date&&!isNaN(this.premiumUntilInput.getTime())&&(t.premiumUntil=this.premiumUntilInput.toISOString());let s=`${S.baseUrl||""}/api`;this.http.post(`${s}/usuarios/${i}/assinatura/premium/ativar`,t).subscribe({next:()=>{this.premiumActivationId=null,this.premiumUntilInput=null,t.premiumUntil&&(this.usersDataSource.data=this.usersDataSource.data.map(c=>c.id===i?ae(ne({},c),{premiumUntil:new Date(t.premiumUntil)}):c)),this.isAdmin?this.loadAllUsers():this.loadCurrentUser()},error:c=>{console.error("Erro ao ativar premium",c)}})}normalizeUser(e){let i=f=>{if(f==null)return null;if(f instanceof Date)return isNaN(f.getTime())?null:f;if(typeof f=="number"){let u=f<1e12?f*1e3:f,M=new Date(u);return isNaN(M.getTime())?null:M}if(typeof f=="string"){if(/^\d{4}-\d{2}-\d{2}/.test(f)){let H=new Date(f);return isNaN(H.getTime())?null:H}let u=f.match(/^(\d{2})\/(\d{2})\/(\d{4})(?:\s+(\d{2}):(\d{2})(?::(\d{2}))?)?$/);if(u){let H=Number(u[1]),De=Number(u[2])-1,qe=Number(u[3]),Ze=Number(u[4]??0),vi=Number(u[5]??0),bi=Number(u[6]??0),We=new Date(qe,De,H,Ze,vi,bi);return isNaN(We.getTime())?null:We}let M=Number(f);return isNaN(M)?null:i(M)}return null},t=e?.createdAt??e?.created_at??e?.created??e?.dataCadastro??e?.data_cadastro??e?.dtCadastro??e?.registrationDate,s=e?.lastLogin??e?.last_login??e?.ultimoLogin??e?.ultimo_login,c=e?.premiumUntil??e?.premium_until;return ae(ne({},e),{createdAt:i(t),lastLogin:i(s),premiumUntil:i(c)})}updatePremiumStatuses(e){let i=`${S.baseUrl||""}/api`;e.forEach(t=>{let s=t?.id;s!=null&&this.http.get(`${i}/usuarios/${s}/assinatura/premium/status`).subscribe({next:c=>{let f=c?.expiraEm?new Date(c.expiraEm):null;this.usersDataSource.data=this.usersDataSource.data.map(u=>u.id===s?ae(ne({},u),{premiumUntil:f}):u)}})})}deleteUser(e){if(!e||!e.id)return;let i=e.id,t=`${S.baseUrl||""}/api`;this.http.delete(`${t}/usuarios/${i}`).subscribe({next:()=>{this.usersDataSource.data=this.usersDataSource.data.filter(s=>s.id!==i),this.totalUsers=this.usersDataSource.data.length},error:s=>{console.error("Erro ao excluir usu\xE1rio",s)}})}applyFilter(e){this.searchValue=e,this.usersDataSource.filter=(e||"").trim().toLowerCase()}loadCurrentUser(){this.loadingUsers=!0;let i=this.authService.getCurrentUserValue()?.id;if(i==null){this.usersDataSource.data=[],this.totalUsers=0,this.loadingUsers=!1;return}let t=`${S.baseUrl||""}/api`;this.http.get(`${t}/usuarios/${i}`).subscribe({next:s=>{let c=s?[this.normalizeUser(s)]:[];this.usersDataSource.data=c,this.totalUsers=this.usersDataSource.data.length,this.loadingUsers=!1,this.paginator&&(this.paginator.pageSize=this.pageSize,this.paginator.firstPage()),c.length&&this.updatePremiumStatuses(c)},error:()=>{this.usersDataSource.data=[],this.totalUsers=0,this.loadingUsers=!1}})}loadAllUsers(){this.loadingUsers=!0;let e=`${S.baseUrl||""}/api`;this.http.get(`${e}/usuarios`).subscribe({next:i=>{let t=Array.isArray(i)?i.map(s=>this.normalizeUser(s)):[];this.usersDataSource.data=t,this.totalUsers=this.usersDataSource.data.length,this.loadingUsers=!1,this.paginator&&(this.paginator.pageSize=this.pageSize,this.paginator.firstPage()),t.length&&this.updatePremiumStatuses(t)},error:()=>{this.usersDataSource.data=[],this.totalUsers=0,this.loadingUsers=!1}})}resetPassword(e){if(!e?.id)return;let i=`${S.baseUrl||""}/api`;this.http.post(`${i}/usuarios/resetar-senha`,{id:e.id}).subscribe({next:()=>{console.log("Senha resetada para usu\xE1rio",e.id)},error:t=>{console.error("Erro ao resetar senha",t)}})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-profile-overview"]],viewQuery:function(i,t){if(i&1&&(Ne(Ie,5),Ne(ke,5)),i&2){let s;$e(s=Be())&&(t.paginator=s.first),$e(s=Be())&&(t.sort=s.first)}},decls:10,vars:4,consts:[["premiumUntilEditTpl",""],["pickerPremiumUntil",""],["premiumEditingTpl",""],[1,"profile-overview"],["dynamicHeight","",1,"futuristic-tabs"],[3,"label"],[1,"tab-content"],["label","AI Settings"],["label","Administrador",4,"ngIf"],["label","Administrador"],[1,"table-card"],[1,"admin-controls","d-flex","align-items-center"],["appearance","outline",1,"user-search-field"],["matInput","","placeholder","Nome, e-mail, ID, role",3,"keyup","value"],[1,"user-table-wrapper"],["mat-table","","matSort","",1,"mat-elevation-z1","w-100","user-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","email"],["matColumnDef","roles"],["matColumnDef","lastLogin"],["matColumnDef","createdAt"],["matColumnDef","premiumUntil"],["matColumnDef","premium"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",1,"m-t-8",3,"pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["matInput","",3,"value","input",4,"ngIf"],[4,"ngIf"],["matInput","",3,"input","value"],[4,"ngIf","ngIfElse"],[1,"premium-until-edit"],["appearance","outline",1,"premium-until-field"],["matInput","",3,"dateChange","matDatepicker","value"],["matSuffix","",3,"for"],[1,"premium-until-actions"],["mat-icon-button","","color","primary","matTooltip","Salvar","aria-label","Salvar",3,"click"],["mat-icon-button","","matTooltip","Cancelar","aria-label","Cancelar",3,"click"],["mat-header-cell",""],[1,"premium-actions"],["mat-icon-button","","color","primary","matTooltip","Ativar Premium","aria-label","Ativar Premium",3,"click"],["mat-icon-button","","color","warn","matTooltip","Desativar Premium","aria-label","Desativar Premium",3,"click"],["mat-icon-button","","color","primary","aria-label","Editar",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Salvar",3,"click",4,"ngIf"],["mat-icon-button","","aria-label","Cancelar",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Resetar senha","aria-label","Resetar senha",3,"click"],["mat-icon-button","","color","warn","aria-label","Excluir",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Editar",3,"click"],["mat-icon-button","","color","primary","aria-label","Salvar",3,"click"],["mat-icon-button","","aria-label","Cancelar",3,"click"],["mat-icon-button","","color","warn","aria-label","Excluir",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,t){i&1&&(r(0,"div",3)(1,"mat-tab-group",4)(2,"mat-tab",5),C(3,"translate"),r(4,"div",6),v(5,"app-profile-settings"),a()(),r(6,"mat-tab",7)(7,"div",6),v(8,"app-ai-settings"),a()(),g(9,yn,41,7,"mat-tab",8),a()()),i&2&&(o(2),p("label",P(3,2,"edit_profile")),o(7),p("ngIf",t.isAdmin))},dependencies:[D,_e,dt,R,V,L,Nt,Lt,Rt,z,K,N,Z,xt,Mt,di,_i,B,$,Wt,$t,Kt,Ht,zt,Bt,Xt,jt,Gt,qt,Zt,wt,Ie,Jt,ke,Yt,J,Y,W,Q,te,ee,ai,ii,ni,ri,bt],styles:["[_nghost-%COMP%]{display:block}.tab-content[_ngcontent-%COMP%]{padding:var(--gutter)}.tradingview-widget-container__widget[_ngcontent-%COMP%]{width:100%;height:100%;background:transparent!important;border-radius:var(--mat-sys-corner-medium)}button[mat-icon-button][_ngcontent-%COMP%]   mat-icon.spin-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.profile-overview[_ngcontent-%COMP%]{padding:var(--gutter);background:transparent;border:1px solid var(--mat-sys-outline);border-radius:var(--mat-sys-corner-medium)}.theme-dark[_ngcontent-%COMP%]   .profile-overview[_ngcontent-%COMP%]{background-color:#0f0f0f!important}.profile-overview[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   mat-card.mat-mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .mat-mdc-card.mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .mat-mdc-card-outlined[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .mdc-card--outlined[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .table-card[_ngcontent-%COMP%]{background-color:transparent!important;border-radius:var(--mat-sys-corner-medium)!important;box-shadow:none!important}.profile-overview[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{background:transparent!important}.profile-overview[_ngcontent-%COMP%]   app-profile-settings[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-profile-settings[_ngcontent-%COMP%]   mat-card.mat-mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-profile-settings[_ngcontent-%COMP%]   .mat-mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-profile-settings[_ngcontent-%COMP%]   .mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-profile-settings[_ngcontent-%COMP%]   .mat-mdc-card-outlined[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-profile-settings[_ngcontent-%COMP%]   .mdc-card--outlined[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important}.profile-overview[_ngcontent-%COMP%]   app-ai-settings[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-ai-settings[_ngcontent-%COMP%]   mat-card.mat-mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-ai-settings[_ngcontent-%COMP%]   .mat-mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-ai-settings[_ngcontent-%COMP%]   .mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-ai-settings[_ngcontent-%COMP%]   .mat-mdc-card-outlined[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   app-ai-settings[_ngcontent-%COMP%]   .mdc-card--outlined[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important}.profile-overview[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{background:transparent!important}.profile-overview[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]{width:100%}.profile-overview[_ngcontent-%COMP%]   .table-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .table-card.mat-mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .table-card.mdc-card[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .table-card.mat-mdc-card-outlined[_ngcontent-%COMP%], .profile-overview[_ngcontent-%COMP%]   .table-card.mdc-card--outlined[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important}.tradingview-widget-container[_ngcontent-%COMP%]{width:100%;height:450px;overflow:hidden;background:transparent}.tradingview-widget-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block!important;width:100%!important;max-width:100%!important;background:transparent!important}.tradingview-widget-container[_ngcontent-%COMP%], .tradingview-widget-container__widget[_ngcontent-%COMP%]{box-sizing:border-box;display:block!important;width:100%!important;max-width:100%!important}.theme-dark[_ngcontent-%COMP%]   .profile-overview[_ngcontent-%COMP%]   .tradingview-widget-container[_ngcontent-%COMP%], .theme-dark[_ngcontent-%COMP%]   .profile-overview[_ngcontent-%COMP%]   .tradingview-widget-container__widget[_ngcontent-%COMP%], .theme-dark[_ngcontent-%COMP%]   .profile-overview[_ngcontent-%COMP%]   .tradingview-widget-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{background:transparent!important}.spin-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.admin-controls[_ngcontent-%COMP%]{gap:12px;margin-bottom:12px}.user-search-field[_ngcontent-%COMP%]{width:100%;max-width:320px}.premium-inputs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;align-items:flex-start}.premium-date-field[_ngcontent-%COMP%]{flex:1 1 240px;width:100%;min-width:200px;max-width:280px}.premium-until-edit[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;align-items:flex-start}.premium-until-field[_ngcontent-%COMP%]{flex:1 1 260px;width:100%;min-width:240px;max-width:320px}.premium-until-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.premium-actions[_ngcontent-%COMP%]{display:flex;gap:6px;align-items:center}.news-actions[_ngcontent-%COMP%]{margin-top:8px}.futuristic-tabs[_ngcontent-%COMP%]   .mat-tab-labels[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.futuristic-tabs[_ngcontent-%COMP%]   .mat-tab-label[_ngcontent-%COMP%]{min-width:unset;padding:8px 12px;font-size:.9rem;font-weight:500;color:var(--mat-sys-on-surface-variant);transition:color .3s ease}.futuristic-tabs[_ngcontent-%COMP%]   .mat-tab-label[_ngcontent-%COMP%]:hover{color:var(--mat-sys-primary)}.futuristic-tabs[_ngcontent-%COMP%]   .mat-tab-label.mat-tab-label-active[_ngcontent-%COMP%]{font-weight:600;color:var(--mat-sys-primary)}.futuristic-tabs[_ngcontent-%COMP%]   .mat-tab-header[_ngcontent-%COMP%]{margin-bottom:12px;border-bottom:2px solid var(--mat-sys-outline)}.futuristic-tabs[_ngcontent-%COMP%]   .mat-ink-bar[_ngcontent-%COMP%]{height:3px;background-color:var(--mat-sys-primary);border-radius:2px}table.mat-mdc-table[_ngcontent-%COMP%]{width:100%}.user-table-wrapper[_ngcontent-%COMP%]{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.user-table[_ngcontent-%COMP%]{table-layout:fixed}.user-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%], .user-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:8px 12px;font-size:.78rem;line-height:1.35;word-break:break-word;overflow-wrap:anywhere}.user-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]{height:auto}.user-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{align-items:flex-start;overflow:visible}.mat-column-premium[_ngcontent-%COMP%]{min-width:240px}.mat-column-username[_ngcontent-%COMP%]{min-width:120px}.mat-column-email[_ngcontent-%COMP%]{min-width:200px}.mat-column-roles[_ngcontent-%COMP%], .mat-column-lastLogin[_ngcontent-%COMP%], .mat-column-createdAt[_ngcontent-%COMP%]{min-width:160px}.mat-column-premiumUntil[_ngcontent-%COMP%]{min-width:220px}.mat-column-actions[_ngcontent-%COMP%]{width:140px}@media (width <= 900px){.user-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%], .user-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:6px 10px;font-size:.76rem}.mat-column-email[_ngcontent-%COMP%]{min-width:180px}.mat-column-roles[_ngcontent-%COMP%]{min-width:140px}}@media (width <= 600px){.premium-until-edit[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.user-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%], .user-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:5px 8px;font-size:.74rem}.mat-column-email[_ngcontent-%COMP%]{min-width:160px}.mat-column-roles[_ngcontent-%COMP%]{min-width:120px}.mat-column-actions[_ngcontent-%COMP%]{width:128px}}"]})}}return n})();var Va=[{path:"",component:si,children:[{path:"",redirectTo:"overview",pathMatch:"full"},{path:"overview",component:hi}]}];export{Va as routes};
